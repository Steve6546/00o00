# ğŸ“§ Hybrid Email System - Complete Architecture

> **Ø§Ù„Ù‡Ø¯Ù:** Ù†Ø¸Ø§Ù… Ø¨Ø±ÙŠØ¯ Hybrid Ø°ÙƒÙŠ Ø¨Ø·Ø¨Ù‚ØªÙŠÙ†
> **ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ­Ø¯ÙŠØ«:** 2024-12-26
> **Ø§Ù„Ù†Ø³Ø®Ø©:** 2.0 - Tiered Architecture

---

## ğŸ¯ Ø§Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    HYBRID EMAIL SYSTEM                              â”‚
â”‚                    Ù†Ø¸Ø§Ù… Ù‡Ø¬ÙŠÙ† Ø¨Ø·Ø¨Ù‚ØªÙŠÙ†                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â–¼                               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚     TIER 1      â”‚   fallback  â”‚     TIER 2      â”‚
    â”‚   Aggressive    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ â”‚     Stable      â”‚
    â”‚     FREE        â”‚             â”‚   LONG-TERM     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                               â”‚
          â–¼                               â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Temp Emails â”‚               â”‚ Maddy + Domain  â”‚
    â”‚ â€¢ 1secmail  â”‚               â”‚ â€¢ yourdomain.comâ”‚
    â”‚ â€¢ Mail.tm   â”‚               â”‚ â€¢ Full control  â”‚
    â”‚ â€¢ Guerrilla â”‚               â”‚ â€¢ Never blocked â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âš¡ Ø³Ù„ÙˆÙƒ Ø§Ù„Ù†Ø¸Ø§Ù…

```python
async def get_email():
    """
    1. ÙŠØ­Ø§ÙˆÙ„ Tier 1 (Ù…Ø¬Ø§Ù†ÙŠ) Ø£ÙˆÙ„Ø§Ù‹
    2. Ø¥Ø°Ø§ ÙØ´Ù„ Ø£Ùˆ Ù…Ø­Ø¸ÙˆØ± â†’ Tier 2 (Ø¯Ø§Ø¦Ù…) ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
    3. Ø¨Ø¯ÙˆÙ† Ø£ÙŠ ØªØ¯Ø®Ù„ ÙŠØ¯ÙˆÙŠ
    """
    
    # Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰: Tier 1
    email = await tier1.get_email()
    if email and await is_accepted_by_roblox(email):
        return email
    
    # Fallback: Tier 2
    return await tier2.get_email()
```

---

## ğŸ“Š Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø·Ø¨Ù‚ØªÙŠÙ†

| Ø§Ù„Ø®Ø§ØµÙŠØ© | Tier 1 (Free) | Tier 2 (Stable) |
|---------|---------------|-----------------|
| **Ø§Ù„ØªÙƒÙ„ÙØ©** | Ù…Ø¬Ø§Ù†ÙŠ | ~$5-15/Ø³Ù†Ø© |
| **Ø§Ù„Ù…ÙˆØ«ÙˆÙ‚ÙŠØ©** | Ù…ØªÙˆØ³Ø·Ø© | Ø¹Ø§Ù„ÙŠØ© Ø¬Ø¯Ø§Ù‹ |
| **Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ø­Ø¸Ø±** | Ù…ÙˆØ¬ÙˆØ¯Ø© | Ù„Ø§ ÙŠÙˆØ¬Ø¯ |
| **Ø§Ù„Ø³Ø±Ø¹Ø©** | Ø³Ø±ÙŠØ¹ | Ø³Ø±ÙŠØ¹ |
| **Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…** | ØªØ¬Ø§Ø±Ø¨ØŒ burst | Ø¥Ù†ØªØ§Ø¬ØŒ long-term |
| **Ø§Ù„ØµÙŠØ§Ù†Ø©** | Ù„Ø§ ÙŠØ­ØªØ§Ø¬ | ÙŠØ­ØªØ§Ø¬ VPS |

---

## ğŸ—ï¸ Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„ÙƒØ§Ù…Ù„

```
src/services/email_system/
â”‚
â”œâ”€â”€ __init__.py                 # Ù†Ù‚Ø·Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
â”œâ”€â”€ hybrid_router.py            # ğŸ§  Ø§Ù„Ù…ÙˆØ¬Ù‡ Ø§Ù„Ø°ÙƒÙŠ Ø¨ÙŠÙ† Tier 1 Ùˆ 2
â”‚
â”œâ”€â”€ tier1/                      # â•â•â• Ø§Ù„Ø·Ø¨Ù‚Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰: Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ© â•â•â•
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ tier1_manager.py        # Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø²ÙˆØ¯Ø§Øª Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ©
â”‚   â”œâ”€â”€ learner.py              # ØªØ¹Ù„Ù… Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ†Ø§Øª Ø§Ù„Ù…Ø­Ø¸ÙˆØ±Ø©
â”‚   â”‚
â”‚   â””â”€â”€ providers/              # Ø§Ù„Ù…Ø²ÙˆØ¯Ø§Øª Ø§Ù„Ù…Ø¬Ø§Ù†ÙŠØ©
â”‚       â”œâ”€â”€ base.py
â”‚       â”œâ”€â”€ onesecmail.py       # 1secmail.com
â”‚       â”œâ”€â”€ mailtm.py           # mail.tm
â”‚       â”œâ”€â”€ guerrilla.py        # guerrillamail
â”‚       â””â”€â”€ tempmail_plus.py    # tempmail.plus
â”‚
â”œâ”€â”€ tier2/                      # â•â•â• Ø§Ù„Ø·Ø¨Ù‚Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ©: Ø§Ù„Ø¯Ø§Ø¦Ù…Ø© â•â•â•
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ tier2_manager.py        # Ø¥Ø¯Ø§Ø±Ø© Maddy
â”‚   â”œâ”€â”€ maddy_controller.py     # Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ù€ Maddy
â”‚   â”œâ”€â”€ dns_updater.py          # ØªØ­Ø¯ÙŠØ« DNS Ø¹Ù†Ø¯ ØªØºÙŠØ± IP
â”‚   â””â”€â”€ recovery_service.py     # Ø§Ø³ØªØ¹Ø§Ø¯Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ©
â”‚
â”œâ”€â”€ shared/                     # â•â•â• Ù…Ø´ØªØ±Ùƒ â•â•â•
â”‚   â”œâ”€â”€ database.py             # SQLite storage
â”‚   â”œâ”€â”€ link_extractor.py       # Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ØªØ­Ù‚Ù‚
â”‚   â””â”€â”€ health_monitor.py       # Ù…Ø±Ø§Ù‚Ø¨Ø© ØµØ­Ø© Ø§Ù„Ù†Ø¸Ø§Ù…
â”‚
â””â”€â”€ config/
    â””â”€â”€ email_config.yaml       # Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
```

---

## ğŸ”„ Workflow Ø§Ù„ÙƒØ§Ù…Ù„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         REQUEST: get_email()                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                                   â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚     Hybrid Router        â”‚
                    â”‚   (ÙŠÙ‚Ø±Ø± Ø£ÙŠ Ø·Ø¨Ù‚Ø© ÙŠØ³ØªØ®Ø¯Ù…) â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                             â”‚
                    â–¼                             â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
         â”‚      TIER 1         â”‚                  â”‚
         â”‚   Tier1Manager      â”‚                  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
                    â”‚                             â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
         â”‚  Learner ÙŠØ³Ø£Ù„:      â”‚                  â”‚
         â”‚  Ø£ÙŠ Ø¯ÙˆÙ…ÙŠÙ† ÙŠØ¹Ù…Ù„ØŸ     â”‚                  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
                    â”‚                             â”‚
              â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”                       â”‚
              â–¼           â–¼                       â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
         â”‚1secmailâ”‚  â”‚mail.tm â”‚  ...              â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
              â”‚           â”‚                       â”‚
              â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                       â”‚
                    â”‚                             â”‚
                    â–¼                             â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
         â”‚   Roblox ÙŠÙ‚Ø¨Ù„ØŸ      â”‚                  â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
              â”‚           â”‚                       â”‚
           Ù†Ø¹Ù… âœ…        Ù„Ø§ âŒ                    â”‚
              â”‚           â”‚                       â”‚
              â–¼           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
         â”‚ Success â”‚                              â–¼
         â”‚ Return  â”‚               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚      TIER 2         â”‚
                                   â”‚   Tier2Manager      â”‚
                                   â”‚   (Maddy + Domain)  â”‚
                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
                                              â–¼
                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                   â”‚   Success (Ø¯Ø§Ø¦Ù…Ø§Ù‹)  â”‚
                                   â”‚   Domain Ø®Ø§Øµ        â”‚
                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…

```yaml
# config/email_config.yaml

hybrid:
  # Ø§Ù„Ø³Ù„ÙˆÙƒ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
  default_tier: 1              # Ø§Ø¨Ø¯Ø£ Ø¨Ù€ Tier 1
  fallback_enabled: true       # Ø§Ù†ØªÙ‚Ù„ Ù„Ù€ Tier 2 Ø¹Ù†Ø¯ Ø§Ù„ÙØ´Ù„
  auto_learn: true             # ØªØ¹Ù„Ù… Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ†Ø§Øª Ø§Ù„Ù…Ø­Ø¸ÙˆØ±Ø©

tier1:
  enabled: true
  providers:
    - name: onesecmail
      enabled: true
      priority: 1
    - name: mailtm
      enabled: true
      priority: 2
    - name: guerrilla
      enabled: true
      priority: 3
  
  learner:
    max_failures_before_block: 3
    retest_after_hours: 24
    
  fallback_to_tier2_after:
    consecutive_failures: 5
    all_providers_blocked: true

tier2:
  enabled: true                 # false Ø¥Ø°Ø§ Ù…Ø§ Ø¹Ù†Ø¯Ùƒ domain
  
  maddy:
    enabled: true
    docker_compose: "deploy/docker-compose.yml"
    auto_restart: true
    
  domain:
    name: ""                    # yourdomain.com
    imap_server: ""             # mail.yourdomain.com
    username: ""
    password: ""                # env: MADDY_PASSWORD
    
  dns:
    provider: cloudflare
    api_token: ""               # env: CLOUDFLARE_API_TOKEN
    zone_id: ""                 # env: CLOUDFLARE_ZONE_ID
    auto_update_ip: true
    check_interval: 300

monitoring:
  enabled: true
  health_check_interval: 60
  alert_on_tier2_fallback: true
  log_all_requests: true
```

---

## ï¿½ Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©

```txt
# requirements-email.txt

# Core
aiohttp>=3.9.0          # HTTP async
httpx>=0.26.0           # Modern HTTP client
asyncio                 # Built-in

# Storage
aiosqlite>=0.19.0       # Async SQLite

# Email (Tier 2)
imaplib                 # Built-in
email                   # Built-in

# Parsing
beautifulsoup4>=4.12.0  # HTML parsing
lxml>=5.0.0             # Fast XML/HTML

# Scheduling
apscheduler>=3.10.0     # Task scheduling

# Monitoring
loguru>=0.7.0           # Better logging

# DNS (Tier 2)
cloudflare>=2.16.0      # Cloudflare API

# Config
pyyaml>=6.0.0           # YAML config
```

---

## ğŸ§  Tier 1: Free Providers

### Ø§Ù„Ù…Ø²ÙˆØ¯Ø§Øª Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ…Ø©

| Ø§Ù„Ù…Ø²ÙˆØ¯ | API | Ø§Ù„Ù…ÙˆØ«ÙˆÙ‚ÙŠØ© | Ø§Ù„Ø­Ø¸Ø± Ù…Ù† Roblox |
|--------|-----|-----------|-----------------|
| 1secmail | REST | â­â­â­â­ | Ù…ØªÙˆØ³Ø· |
| Mail.tm | REST | â­â­â­â­ | Ù…ØªÙˆØ³Ø· |
| Guerrilla | REST | â­â­â­ | Ø¹Ø§Ù„ÙŠ |
| TempMail+ | REST | â­â­â­ | Ù…Ù†Ø®ÙØ¶ |

### Ù…Ù†Ø·Ù‚ Ø§Ù„ØªØ¹Ù„Ù…

```python
class DomainLearner:
    """
    ÙŠØªØªØ¨Ø¹ Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ†Ø§Øª ÙˆÙŠØªØ¹Ù„Ù… Ø£ÙŠÙ‡Ø§ Ù…Ø­Ø¸ÙˆØ±
    """
    
    async def record_result(self, domain: str, accepted: bool):
        """
        Ø¨Ø¹Ø¯ ÙƒÙ„ Ù…Ø­Ø§ÙˆÙ„Ø©:
        - accepted=True â†’ Ø²ÙŠØ§Ø¯Ø© success_count
        - accepted=False â†’ Ø²ÙŠØ§Ø¯Ø© fail_count
        - fail_count >= 3 â†’ mark as blocked
        """
    
    async def get_best_provider(self) -> str:
        """
        ÙŠØ±Ø¬Ø¹ Ø§Ù„Ù…Ø²ÙˆØ¯ Ø¨Ø£Ø¹Ù„Ù‰ Ù†Ø³Ø¨Ø© Ù†Ø¬Ø§Ø­
        ÙˆÙŠØªØ¬Ù†Ø¨ Ø§Ù„Ø¯ÙˆÙ…ÙŠÙ†Ø§Øª Ø§Ù„Ù…Ø­Ø¸ÙˆØ±Ø©
        """
    
    async def should_fallback_to_tier2(self) -> bool:
        """
        True Ø¥Ø°Ø§:
        - ÙƒÙ„ Ø§Ù„Ù…Ø²ÙˆØ¯Ø§Øª Ù…Ø­Ø¸ÙˆØ±Ø©
        - Ø£Ùˆ 5 ÙØ´Ù„ Ù…ØªØªØ§Ù„ÙŠ
        """
```

---

## ğŸ  Tier 2: Maddy + Own Domain

### Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª

```python
class Tier2Manager:
    """
    Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¯Ø§Ø¦Ù…
    """
    
    def __init__(self):
        self.maddy = MaddyController()
        self.dns = CloudflareDNSUpdater()
        self.recovery = RecoveryService()
    
    async def get_email(self) -> str:
        """
        1. ØªØ£ÙƒØ¯ Maddy ÙŠØ¹Ù…Ù„
        2. ÙˆÙ„Ù‘Ø¯ Ø¥ÙŠÙ…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯
        3. Ø£Ø±Ø¬Ø¹Ù‡
        """
    
    async def ensure_running(self):
        """
        - ÙØ­Øµ Maddy
        - Ø¥Ø¹Ø§Ø¯Ø© ØªØ´ØºÙŠÙ„ Ø¥Ø°Ø§ Ù…ØªÙˆÙ‚Ù
        - ØªØ­Ø¯ÙŠØ« DNS Ø¥Ø°Ø§ ØªØºÙŠØ± IP
        """
```

### DNS Auto-Update

```python
class CloudflareDNSUpdater:
    """
    ØªØ­Ø¯ÙŠØ« DNS ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ ØªØºÙŠØ± IP
    """
    
    async def check_and_update(self):
        current_ip = await self.get_current_ip()
        dns_ip = await self.get_dns_ip()
        
        if current_ip != dns_ip:
            await self.update_dns(current_ip)
            logger.info(f"DNS updated: {dns_ip} â†’ {current_ip}")
```

---

## ğŸš€ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…

```python
from src.services.email_system import HybridEmailSystem

# Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù†Ø¸Ø§Ù…
email_system = HybridEmailSystem()

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¹Ø§Ø¯ÙŠ (ØªÙ„Ù‚Ø§Ø¦ÙŠ)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¥ÙŠÙ…ÙŠÙ„ (ÙŠØ®ØªØ§Ø± Tier ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹)
email = await email_system.get_email()
# Result: "xyz123@1secmail.com" (Tier 1)
# Ø£Ùˆ: "random@yourdomain.com" (Tier 2 Ø¥Ø°Ø§ Tier 1 ÙØ´Ù„)

# Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„ØªØ­Ù‚Ù‚
link = await email_system.wait_for_verification(
    email=email,
    timeout=120
)

# ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù†ØªÙŠØ¬Ø© (Ù„Ù„ØªØ¹Ù„Ù…)
await email_system.report_result(email, success=True)


# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ØªØ­ÙƒÙ… Ù…ØªÙ‚Ø¯Ù… (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Ø¥Ø¬Ø¨Ø§Ø± Tier Ù…Ø¹ÙŠÙ†
email = await email_system.get_email(force_tier=1)
email = await email_system.get_email(force_tier=2)

# Ù…Ø¹Ø±ÙØ© Ø£ÙŠ Tier Ø§Ø³ØªÙØ®Ø¯Ù…
info = email_system.last_email_info
print(info.tier)      # 1 Ø£Ùˆ 2
print(info.provider)  # "1secmail" Ø£Ùˆ "maddy"

# Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
stats = await email_system.get_stats()
print(f"Tier 1 success rate: {stats.tier1_success_rate}%")
print(f"Tier 2 fallbacks: {stats.tier2_fallback_count}")
```

---

## ğŸ“‹ Ø®Ø·Ø© Ø§Ù„ØªÙ†ÙÙŠØ°

### Phase 1: Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ (2-3 Ø³Ø§Ø¹Ø§Øª)
- [ ] Ø¥Ù†Ø´Ø§Ø¡ Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù…Ù„ÙØ§Øª
- [ ] HybridRouter
- [ ] Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´ØªØ±ÙƒØ©

### Phase 2: Tier 1 (3-4 Ø³Ø§Ø¹Ø§Øª)
- [ ] Tier1Manager
- [ ] DomainLearner
- [ ] Providers (4 Ù…Ø²ÙˆØ¯Ø§Øª)
- [ ] Ø§Ø®ØªØ¨Ø§Ø± Ù…Ø¹ Roblox

### Phase 3: Tier 2 (3-4 Ø³Ø§Ø¹Ø§Øª)
- [ ] Tier2Manager
- [ ] MaddyController
- [ ] CloudflareDNSUpdater
- [ ] RecoveryService

### Phase 4: Ø§Ù„ØªÙƒØ§Ù…Ù„ (2 Ø³Ø§Ø¹Ø§Øª)
- [ ] Ø±Ø¨Ø· Ù…Ø¹ Bot Ø§Ù„Ø­Ø§Ù„ÙŠ
- [ ] Ø§Ø®ØªØ¨Ø§Ø± Fallback
- [ ] Ø§Ù„ØªÙˆØ«ÙŠÙ‚ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ

---

## âœ… Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Ø¨Ø¹Ø¯ Ø§Ù„ØªÙ†ÙÙŠØ°                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âœ… Ø³Ø·Ø± ÙˆØ§Ø­Ø¯ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø¥ÙŠÙ…ÙŠÙ„                                  â”‚
â”‚  âœ… Tier 1 Ù…Ø¬Ø§Ù†ÙŠ Ù„Ù„ØªØ¬Ø§Ø±Ø¨ Ø§Ù„Ø³Ø±ÙŠØ¹Ø©                                â”‚
â”‚  âœ… Tier 2 Ù…Ø³ØªÙ‚Ø± Ù„Ù„Ø¥Ù†ØªØ§Ø¬                                        â”‚
â”‚  âœ… Fallback ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¨Ø¯ÙˆÙ† ØªØ¯Ø®Ù„                                   â”‚
â”‚  âœ… ØªØ¹Ù„Ù… Ø°Ø§ØªÙŠ Ù„Ù„Ø¯ÙˆÙ…ÙŠÙ†Ø§Øª Ø§Ù„Ù…Ø­Ø¸ÙˆØ±Ø©                                â”‚
â”‚  âœ… Ø§Ø³ØªØ¹Ø§Ø¯Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ© Ø¹Ù†Ø¯ Ø§Ù„Ø³Ù‚ÙˆØ·                                  â”‚
â”‚  âœ… ØªØ­Ø¯ÙŠØ« DNS ØªÙ„Ù‚Ø§Ø¦ÙŠ                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âš¡ Ø¬Ø§Ù‡Ø² Ù„Ù„ØªÙ†ÙÙŠØ°

Ù‡Ù„ Ø£Ø¨Ø¯Ø£ Ø¨Ù€ Phase 1 Ø§Ù„Ø¢Ù†ØŸ
